(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function t(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(a){if(a.ep)return;a.ep=!0;const s=t(a);fetch(a.href,s)}})();var G=function(r,e){return G=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])},G(r,e)};function T(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");G(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}function xe(r,e,t,n){function a(s){return s instanceof t?s:new t(function(i){i(s)})}return new(t||(t=Promise))(function(s,i){function c(u){try{o(n.next(u))}catch(p){i(p)}}function l(u){try{o(n.throw(u))}catch(p){i(p)}}function o(u){u.done?s(u.value):a(u.value).then(c,l)}o((n=n.apply(r,e||[])).next())})}function ee(r,e){var t={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,a,s,i=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return i.next=c(0),i.throw=c(1),i.return=c(2),typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function c(o){return function(u){return l([o,u])}}function l(o){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,o[0]&&(t=0)),t;)try{if(n=1,a&&(s=o[0]&2?a.return:o[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,o[1])).done)return s;switch(a=0,s&&(o=[o[0]&2,s.value]),o[0]){case 0:case 1:s=o;break;case 4:return t.label++,{value:o[1],done:!1};case 5:t.label++,a=o[1],o=[0];continue;case 7:o=t.ops.pop(),t.trys.pop();continue;default:if(s=t.trys,!(s=s.length>0&&s[s.length-1])&&(o[0]===6||o[0]===2)){t=0;continue}if(o[0]===3&&(!s||o[1]>s[0]&&o[1]<s[3])){t.label=o[1];break}if(o[0]===6&&t.label<s[1]){t.label=s[1],s=o;break}if(s&&t.label<s[2]){t.label=s[2],t.ops.push(o);break}s[2]&&t.ops.pop(),t.trys.pop();continue}o=e.call(r,t)}catch(u){o=[6,u],a=0}finally{n=s=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}}function L(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function $(r,e){var t=typeof Symbol=="function"&&r[Symbol.iterator];if(!t)return r;var n=t.call(r),a,s=[],i;try{for(;(e===void 0||e-- >0)&&!(a=n.next()).done;)s.push(a.value)}catch(c){i={error:c}}finally{try{a&&!a.done&&(t=n.return)&&t.call(n)}finally{if(i)throw i.error}}return s}function A(r,e,t){if(t||arguments.length===2)for(var n=0,a=e.length,s;n<a;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return r.concat(s||Array.prototype.slice.call(e))}function B(r){return this instanceof B?(this.v=r,this):new B(r)}function we(r,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(r,e||[]),a,s=[];return a=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),c("next"),c("throw"),c("return",i),a[Symbol.asyncIterator]=function(){return this},a;function i(d){return function(g){return Promise.resolve(g).then(d,p)}}function c(d,g){n[d]&&(a[d]=function(m){return new Promise(function(_,k){s.push([d,m,_,k])>1||l(d,m)})},g&&(a[d]=g(a[d])))}function l(d,g){try{o(n[d](g))}catch(m){v(s[0][3],m)}}function o(d){d.value instanceof B?Promise.resolve(d.value.v).then(u,p):v(s[0][2],d)}function u(d){l("next",d)}function p(d){l("throw",d)}function v(d,g){d(g),s.shift(),s.length&&l(s[0][0],s[0][1])}}function Te(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=r[Symbol.asyncIterator],t;return e?e.call(r):(r=typeof L=="function"?L(r):r[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(s){t[s]=r[s]&&function(i){return new Promise(function(c,l){i=r[s](i),a(c,l,i.done,i.value)})}}function a(s,i,c,l){Promise.resolve(l).then(function(o){s({value:o,done:c})},i)}}function f(r){return typeof r=="function"}function te(r){var e=function(n){Error.call(n),n.stack=new Error().stack},t=r(e);return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var V=te(function(r){return function(t){r(this),this.message=t?t.length+` errors occurred during unsubscription:
`+t.map(function(n,a){return a+1+") "+n.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=t}});function R(r,e){if(r){var t=r.indexOf(e);0<=t&&r.splice(t,1)}}var D=(function(){function r(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return r.prototype.unsubscribe=function(){var e,t,n,a,s;if(!this.closed){this.closed=!0;var i=this._parentage;if(i)if(this._parentage=null,Array.isArray(i))try{for(var c=L(i),l=c.next();!l.done;l=c.next()){var o=l.value;o.remove(this)}}catch(m){e={error:m}}finally{try{l&&!l.done&&(t=c.return)&&t.call(c)}finally{if(e)throw e.error}}else i.remove(this);var u=this.initialTeardown;if(f(u))try{u()}catch(m){s=m instanceof V?m.errors:[m]}var p=this._finalizers;if(p){this._finalizers=null;try{for(var v=L(p),d=v.next();!d.done;d=v.next()){var g=d.value;try{H(g)}catch(m){s=s??[],m instanceof V?s=A(A([],$(s)),$(m.errors)):s.push(m)}}}catch(m){n={error:m}}finally{try{d&&!d.done&&(a=v.return)&&a.call(v)}finally{if(n)throw n.error}}}if(s)throw new V(s)}},r.prototype.add=function(e){var t;if(e&&e!==this)if(this.closed)H(e);else{if(e instanceof r){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}},r.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},r.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},r.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&R(t,e)},r.prototype.remove=function(e){var t=this._finalizers;t&&R(t,e),e instanceof r&&e._removeParent(this)},r.EMPTY=(function(){var e=new r;return e.closed=!0,e})(),r})(),ne=D.EMPTY;function re(r){return r instanceof D||r&&"closed"in r&&f(r.remove)&&f(r.add)&&f(r.unsubscribe)}function H(r){f(r)?r():r.unsubscribe()}var Me={Promise:void 0},Ie={setTimeout:function(r,e){for(var t=[],n=2;n<arguments.length;n++)t[n-2]=arguments[n];return setTimeout.apply(void 0,A([r,e],$(t)))},clearTimeout:function(r){return clearTimeout(r)},delegate:void 0};function ae(r){Ie.setTimeout(function(){throw r})}function Y(){}function j(r){r()}var q=(function(r){T(e,r);function e(t){var n=r.call(this)||this;return n.isStopped=!1,t?(n.destination=t,re(t)&&t.add(n)):n.destination=Se,n}return e.create=function(t,n,a){return new F(t,n,a)},e.prototype.next=function(t){this.isStopped||this._next(t)},e.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,r.prototype.unsubscribe.call(this),this.destination=null)},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){try{this.destination.error(t)}finally{this.unsubscribe()}},e.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},e})(D),Ee=(function(){function r(e){this.partialObserver=e}return r.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(n){O(n)}},r.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(n){O(n)}else O(e)},r.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(t){O(t)}},r})(),F=(function(r){T(e,r);function e(t,n,a){var s=r.call(this)||this,i;return f(t)||!t?i={next:t??void 0,error:n??void 0,complete:a??void 0}:i=t,s.destination=new Ee(i),s}return e})(q);function O(r){ae(r)}function Pe(r){throw r}var Se={closed:!0,next:Y,error:Pe,complete:Y},N=(function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"})();function z(r){return r}function Be(r){return r.length===0?z:r.length===1?r[0]:function(t){return r.reduce(function(n,a){return a(n)},t)}}var b=(function(){function r(e){e&&(this._subscribe=e)}return r.prototype.lift=function(e){var t=new r;return t.source=this,t.operator=e,t},r.prototype.subscribe=function(e,t,n){var a=this,s=Le(e)?e:new F(e,t,n);return j(function(){var i=a,c=i.operator,l=i.source;s.add(c?c.call(s,l):l?a._subscribe(s):a._trySubscribe(s))}),s},r.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},r.prototype.forEach=function(e,t){var n=this;return t=J(t),new t(function(a,s){var i=new F({next:function(c){try{e(c)}catch(l){s(l),i.unsubscribe()}},error:s,complete:a});n.subscribe(i)})},r.prototype._subscribe=function(e){var t;return(t=this.source)===null||t===void 0?void 0:t.subscribe(e)},r.prototype[N]=function(){return this},r.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Be(e)(this)},r.prototype.toPromise=function(e){var t=this;return e=J(e),new e(function(n,a){var s;t.subscribe(function(i){return s=i},function(i){return a(i)},function(){return n(s)})})},r.create=function(e){return new r(e)},r})();function J(r){var e;return(e=r??Me.Promise)!==null&&e!==void 0?e:Promise}function Ce(r){return r&&f(r.next)&&f(r.error)&&f(r.complete)}function Le(r){return r&&r instanceof q||Ce(r)&&re(r)}function $e(r){return f(r?.lift)}function E(r){return function(e){if($e(e))return e.lift(function(t){try{return r(t,this)}catch(n){this.error(n)}});throw new TypeError("Unable to lift unknown Observable type")}}function I(r,e,t,n,a){return new ke(r,e,t,n,a)}var ke=(function(r){T(e,r);function e(t,n,a,s,i,c){var l=r.call(this,t)||this;return l.onFinalize=i,l.shouldUnsubscribe=c,l._next=n?function(o){try{n(o)}catch(u){t.error(u)}}:r.prototype._next,l._error=s?function(o){try{s(o)}catch(u){t.error(u)}finally{this.unsubscribe()}}:r.prototype._error,l._complete=a?function(){try{a()}catch(o){t.error(o)}finally{this.unsubscribe()}}:r.prototype._complete,l}return e.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var n=this.closed;r.prototype.unsubscribe.call(this),!n&&((t=this.onFinalize)===null||t===void 0||t.call(this))}},e})(q),Ae=te(function(r){return function(){r(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),se=(function(r){T(e,r);function e(){var t=r.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return e.prototype.lift=function(t){var n=new Q(this,this);return n.operator=t,n},e.prototype._throwIfClosed=function(){if(this.closed)throw new Ae},e.prototype.next=function(t){var n=this;j(function(){var a,s;if(n._throwIfClosed(),!n.isStopped){n.currentObservers||(n.currentObservers=Array.from(n.observers));try{for(var i=L(n.currentObservers),c=i.next();!c.done;c=i.next()){var l=c.value;l.next(t)}}catch(o){a={error:o}}finally{try{c&&!c.done&&(s=i.return)&&s.call(i)}finally{if(a)throw a.error}}}})},e.prototype.error=function(t){var n=this;j(function(){if(n._throwIfClosed(),!n.isStopped){n.hasError=n.isStopped=!0,n.thrownError=t;for(var a=n.observers;a.length;)a.shift().error(t)}})},e.prototype.complete=function(){var t=this;j(function(){if(t._throwIfClosed(),!t.isStopped){t.isStopped=!0;for(var n=t.observers;n.length;)n.shift().complete()}})},e.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(e.prototype,"observed",{get:function(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0},enumerable:!1,configurable:!0}),e.prototype._trySubscribe=function(t){return this._throwIfClosed(),r.prototype._trySubscribe.call(this,t)},e.prototype._subscribe=function(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)},e.prototype._innerSubscribe=function(t){var n=this,a=this,s=a.hasError,i=a.isStopped,c=a.observers;return s||i?ne:(this.currentObservers=null,c.push(t),new D(function(){n.currentObservers=null,R(c,t)}))},e.prototype._checkFinalizedStatuses=function(t){var n=this,a=n.hasError,s=n.thrownError,i=n.isStopped;a?t.error(s):i&&t.complete()},e.prototype.asObservable=function(){var t=new b;return t.source=this,t},e.create=function(t,n){return new Q(t,n)},e})(b),Q=(function(r){T(e,r);function e(t,n){var a=r.call(this)||this;return a.destination=t,a.source=n,a}return e.prototype.next=function(t){var n,a;(a=(n=this.destination)===null||n===void 0?void 0:n.next)===null||a===void 0||a.call(n,t)},e.prototype.error=function(t){var n,a;(a=(n=this.destination)===null||n===void 0?void 0:n.error)===null||a===void 0||a.call(n,t)},e.prototype.complete=function(){var t,n;(n=(t=this.destination)===null||t===void 0?void 0:t.complete)===null||n===void 0||n.call(t)},e.prototype._subscribe=function(t){var n,a;return(a=(n=this.source)===null||n===void 0?void 0:n.subscribe(t))!==null&&a!==void 0?a:ne},e})(se),De=(function(r){T(e,r);function e(t){var n=r.call(this)||this;return n._value=t,n}return Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),e.prototype._subscribe=function(t){var n=r.prototype._subscribe.call(this,t);return!n.closed&&t.next(this._value),n},e.prototype.getValue=function(){var t=this,n=t.hasError,a=t.thrownError,s=t._value;if(n)throw a;return this._throwIfClosed(),s},e.prototype.next=function(t){r.prototype.next.call(this,this._value=t)},e})(se),_e={now:function(){return Date.now()}},Oe=(function(r){T(e,r);function e(t,n){return r.call(this)||this}return e.prototype.schedule=function(t,n){return this},e})(D),W={setInterval:function(r,e){for(var t=[],n=2;n<arguments.length;n++)t[n-2]=arguments[n];return setInterval.apply(void 0,A([r,e],$(t)))},clearInterval:function(r){return clearInterval(r)},delegate:void 0},je=(function(r){T(e,r);function e(t,n){var a=r.call(this,t,n)||this;return a.scheduler=t,a.work=n,a.pending=!1,a}return e.prototype.schedule=function(t,n){var a;if(n===void 0&&(n=0),this.closed)return this;this.state=t;var s=this.id,i=this.scheduler;return s!=null&&(this.id=this.recycleAsyncId(i,s,n)),this.pending=!0,this.delay=n,this.id=(a=this.id)!==null&&a!==void 0?a:this.requestAsyncId(i,this.id,n),this},e.prototype.requestAsyncId=function(t,n,a){return a===void 0&&(a=0),W.setInterval(t.flush.bind(t,this),a)},e.prototype.recycleAsyncId=function(t,n,a){if(a===void 0&&(a=0),a!=null&&this.delay===a&&this.pending===!1)return n;n!=null&&W.clearInterval(n)},e.prototype.execute=function(t,n){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var a=this._execute(t,n);if(a)return a;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},e.prototype._execute=function(t,n){var a=!1,s;try{this.work(t)}catch(i){a=!0,s=i||new Error("Scheduled action threw falsy error")}if(a)return this.unsubscribe(),s},e.prototype.unsubscribe=function(){if(!this.closed){var t=this,n=t.id,a=t.scheduler,s=a.actions;this.work=this.state=this.scheduler=null,this.pending=!1,R(s,this),n!=null&&(this.id=this.recycleAsyncId(a,n,null)),this.delay=null,r.prototype.unsubscribe.call(this)}},e})(Oe),X=(function(){function r(e,t){t===void 0&&(t=r.now),this.schedulerActionCtor=e,this.now=t}return r.prototype.schedule=function(e,t,n){return t===void 0&&(t=0),new this.schedulerActionCtor(this,e).schedule(n,t)},r.now=_e.now,r})(),Re=(function(r){T(e,r);function e(t,n){n===void 0&&(n=X.now);var a=r.call(this,t,n)||this;return a.actions=[],a._active=!1,a}return e.prototype.flush=function(t){var n=this.actions;if(this._active){n.push(t);return}var a;this._active=!0;do if(a=t.execute(t.state,t.delay))break;while(t=n.shift());if(this._active=!1,a){for(;t=n.shift();)t.unsubscribe();throw a}},e})(X),Ue=new Re(je);function Ve(r){return r&&f(r.schedule)}function Ge(r){return r[r.length-1]}function Fe(r){return Ve(Ge(r))?r.pop():void 0}var K=(function(r){return r&&typeof r.length=="number"&&typeof r!="function"});function ie(r){return f(r?.then)}function oe(r){return f(r[N])}function le(r){return Symbol.asyncIterator&&f(r?.[Symbol.asyncIterator])}function ce(r){return new TypeError("You provided "+(r!==null&&typeof r=="object"?"an invalid object":"'"+r+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function qe(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var ue=qe();function de(r){return f(r?.[ue])}function fe(r){return we(this,arguments,function(){var t,n,a,s;return ee(this,function(i){switch(i.label){case 0:t=r.getReader(),i.label=1;case 1:i.trys.push([1,,9,10]),i.label=2;case 2:return[4,B(t.read())];case 3:return n=i.sent(),a=n.value,s=n.done,s?[4,B(void 0)]:[3,5];case 4:return[2,i.sent()];case 5:return[4,B(a)];case 6:return[4,i.sent()];case 7:return i.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}})})}function he(r){return f(r?.getReader)}function S(r){if(r instanceof b)return r;if(r!=null){if(oe(r))return Ne(r);if(K(r))return ze(r);if(ie(r))return Ke(r);if(le(r))return me(r);if(de(r))return He(r);if(he(r))return Ye(r)}throw ce(r)}function Ne(r){return new b(function(e){var t=r[N]();if(f(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function ze(r){return new b(function(e){for(var t=0;t<r.length&&!e.closed;t++)e.next(r[t]);e.complete()})}function Ke(r){return new b(function(e){r.then(function(t){e.closed||(e.next(t),e.complete())},function(t){return e.error(t)}).then(null,ae)})}function He(r){return new b(function(e){var t,n;try{for(var a=L(r),s=a.next();!s.done;s=a.next()){var i=s.value;if(e.next(i),e.closed)return}}catch(c){t={error:c}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}e.complete()})}function me(r){return new b(function(e){Je(r,e).catch(function(t){return e.error(t)})})}function Ye(r){return me(fe(r))}function Je(r,e){var t,n,a,s;return xe(this,void 0,void 0,function(){var i,c;return ee(this,function(l){switch(l.label){case 0:l.trys.push([0,5,6,11]),t=Te(r),l.label=1;case 1:return[4,t.next()];case 2:if(n=l.sent(),!!n.done)return[3,4];if(i=n.value,e.next(i),e.closed)return[2];l.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return c=l.sent(),a={error:c},[3,11];case 6:return l.trys.push([6,,9,10]),n&&!n.done&&(s=t.return)?[4,s.call(t)]:[3,8];case 7:l.sent(),l.label=8;case 8:return[3,10];case 9:if(a)throw a.error;return[7];case 10:return[7];case 11:return e.complete(),[2]}})})}function P(r,e,t,n,a){n===void 0&&(n=0),a===void 0&&(a=!1);var s=e.schedule(function(){t(),a?r.add(this.schedule(null,n)):this.unsubscribe()},n);if(r.add(s),!a)return s}function ge(r,e){return e===void 0&&(e=0),E(function(t,n){t.subscribe(I(n,function(a){return P(n,r,function(){return n.next(a)},e)},function(){return P(n,r,function(){return n.complete()},e)},function(a){return P(n,r,function(){return n.error(a)},e)}))})}function pe(r,e){return e===void 0&&(e=0),E(function(t,n){n.add(r.schedule(function(){return t.subscribe(n)},e))})}function Qe(r,e){return S(r).pipe(pe(e),ge(e))}function We(r,e){return S(r).pipe(pe(e),ge(e))}function Xe(r,e){return new b(function(t){var n=0;return e.schedule(function(){n===r.length?t.complete():(t.next(r[n++]),t.closed||this.schedule())})})}function Ze(r,e){return new b(function(t){var n;return P(t,e,function(){n=r[ue](),P(t,e,function(){var a,s,i;try{a=n.next(),s=a.value,i=a.done}catch(c){t.error(c);return}i?t.complete():t.next(s)},0,!0)}),function(){return f(n?.return)&&n.return()}})}function be(r,e){if(!r)throw new Error("Iterable cannot be null");return new b(function(t){P(t,e,function(){var n=r[Symbol.asyncIterator]();P(t,e,function(){n.next().then(function(a){a.done?t.complete():t.next(a.value)})},0,!0)})})}function et(r,e){return be(fe(r),e)}function tt(r,e){if(r!=null){if(oe(r))return Qe(r,e);if(K(r))return Xe(r,e);if(ie(r))return We(r,e);if(le(r))return be(r,e);if(de(r))return Ze(r,e);if(he(r))return et(r,e)}throw ce(r)}function y(r,e){return e?tt(r,e):S(r)}function M(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];var t=Fe(r);return y(r,t)}function C(r,e){return E(function(t,n){var a=0;t.subscribe(I(n,function(s){n.next(r.call(e,s,a++))}))})}var nt=Array.isArray;function rt(r,e){return nt(e)?r.apply(void 0,A([],$(e))):r(e)}function at(r){return C(function(e){return rt(r,e)})}function st(r,e,t,n,a,s,i,c){var l=[],o=0,u=0,p=!1,v=function(){p&&!l.length&&!o&&e.complete()},d=function(m){return o<n?g(m):l.push(m)},g=function(m){o++;var _=!1;S(t(m,u++)).subscribe(I(e,function(k){e.next(k)},function(){_=!0},void 0,function(){if(_)try{o--;for(var k=function(){var U=l.shift();i||g(U)};l.length&&o<n;)k();v()}catch(U){e.error(U)}}))};return r.subscribe(I(e,d,function(){p=!0,v()})),function(){}}function ve(r,e,t){return t===void 0&&(t=1/0),f(e)?ve(function(n,a){return C(function(s,i){return e(n,s,a,i)})(S(r(n,a)))},t):(typeof e=="number"&&(t=e),E(function(n,a){return st(n,a,r,t)}))}var it=["addListener","removeListener"],ot=["addEventListener","removeEventListener"],lt=["on","off"];function h(r,e,t,n){if(f(t)&&(n=t,t=void 0),n)return h(r,e,t).pipe(at(n));var a=$(dt(r)?ot.map(function(c){return function(l){return r[c](e,l,t)}}):ct(r)?it.map(Z(r,e)):ut(r)?lt.map(Z(r,e)):[],2),s=a[0],i=a[1];if(!s&&K(r))return ve(function(c){return h(c,e,t)})(S(r));if(!s)throw new TypeError("Invalid event target");return new b(function(c){var l=function(){for(var o=[],u=0;u<arguments.length;u++)o[u]=arguments[u];return c.next(1<o.length?o:o[0])};return s(l),function(){return i(l)}})}function Z(r,e){return function(t){return function(n){return r[t](e,n)}}}function ct(r){return f(r.addListener)&&f(r.removeListener)}function ut(r){return f(r.on)&&f(r.off)}function dt(r){return f(r.addEventListener)&&f(r.removeEventListener)}function x(r){return E(function(e,t){var n=null,a=!1,s;n=e.subscribe(I(t,void 0,void 0,function(i){s=S(r(i,x(r)(e))),n?(n.unsubscribe(),n=null,s.subscribe(t)):a=!0})),a&&(n.unsubscribe(),n=null,s.subscribe(t))})}function ft(r,e){return e===void 0&&(e=Ue),E(function(t,n){var a=null,s=null,i=null,c=function(){if(a){a.unsubscribe(),a=null;var o=s;s=null,n.next(o)}};function l(){var o=i+r,u=e.now();if(u<o){a=this.schedule(void 0,o-u),n.add(a);return}c()}t.subscribe(I(n,function(o){s=o,i=e.now(),a||(a=e.schedule(l,r),n.add(a))},function(){c(),n.complete()},void 0,function(){s=a=null}))})}function ht(r,e){return e===void 0&&(e=z),r=r??mt,E(function(t,n){var a,s=!0;t.subscribe(I(n,function(i){var c=e(i);(s||!r(a,c))&&(s=!1,a=c,n.next(i))}))})}function mt(r,e){return r===e}function gt(r,e,t){var n=f(r)||e||t?{next:r,error:e,complete:t}:r;return n?E(function(a,s){var i;(i=n.subscribe)===null||i===void 0||i.call(n);var c=!0;a.subscribe(I(s,function(l){var o;(o=n.next)===null||o===void 0||o.call(n,l),s.next(l)},function(){var l;c=!1,(l=n.complete)===null||l===void 0||l.call(n),s.complete()},function(l){var o;c=!1,(o=n.error)===null||o===void 0||o.call(n,l),s.error(l)},function(){var l,o;c&&((l=n.unsubscribe)===null||l===void 0||l.call(n)),(o=n.finalize)===null||o===void 0||o.call(n)}))}):z}class pt{constructor(){this.stateSubject$=new De({currentTab:"characters",currentPage:1,searchTerm:"",isLoading:!1,characters:[],planets:[],transformations:[],totalCharacters:0,totalPlanets:0,totalTransformations:0,totalPages:1,currentView:"home",currentDetailId:null,currentDetailType:null}),this.cacheMap=new Map,this.dataLoadedFlags={characters:!1,planets:!1,transformations:!1,stats:!1}}get state$(){return this.stateSubject$.asObservable()}get currentState(){return this.stateSubject$.value}get cache(){return this.cacheMap}get dataLoaded(){return this.dataLoadedFlags}updateState(e){const t=this.stateSubject$.value;this.stateSubject$.next({...t,...e})}getCacheKey(e,t,n=""){return`${e}-${t}-${n}`}getCachedData(e){return this.cacheMap.get(e)}setCachedData(e,t){this.cacheMap.set(e,t)}hasCachedData(e){return this.cacheMap.has(e)}setDataLoaded(e,t){this.dataLoadedFlags[e]=t}isDataLoaded(e){return this.dataLoadedFlags[e]}}class bt{constructor(){this.elements={homeView:null,detailView:null,contentGrid:null,loadingSpinner:null,errorMessage:null,searchInput:null,mobileMenu:null,mobileMenuBtn:null,charactersTab:null,planetsTab:null,transformationsTab:null,charactersTabMobile:null,planetsTabMobile:null,transformationsTabMobile:null,prevBtn:null,nextBtn:null,closeErrorBtn:null,backBtn:null,closeTransformationModalBtn:null,prevTransformationBtn:null,nextTransformationBtn:null,playTransformationBtn:null,errorText:null,pageInfo:null,totalCharacters:null,totalPlanets:null,totalTransformations:null,detailContent:null},this.isToggling=!1,this.mobileMenuOpen=!1,this.initializeElements()}initializeElements(){this.elements.homeView=document.getElementById("home-view"),this.elements.detailView=document.getElementById("detail-view"),this.elements.contentGrid=document.getElementById("content-grid"),this.elements.loadingSpinner=document.getElementById("loading"),this.elements.errorMessage=document.getElementById("error-message"),this.elements.searchInput=document.getElementById("search-input"),this.elements.mobileMenu=document.getElementById("mobile-menu"),this.elements.mobileMenuBtn=document.getElementById("mobile-menu-btn"),this.elements.charactersTab=document.getElementById("characters-tab"),this.elements.planetsTab=document.getElementById("planets-tab"),this.elements.transformationsTab=document.getElementById("transformations-tab"),this.elements.charactersTabMobile=document.getElementById("characters-tab-mobile"),this.elements.planetsTabMobile=document.getElementById("planets-tab-mobile"),this.elements.transformationsTabMobile=document.getElementById("transformations-tab-mobile"),this.elements.prevBtn=document.getElementById("prev-page"),this.elements.nextBtn=document.getElementById("next-page"),this.elements.closeErrorBtn=document.getElementById("close-error"),this.elements.backBtn=document.getElementById("back-btn"),this.elements.closeTransformationModalBtn=document.getElementById("close-transformation-modal"),this.elements.prevTransformationBtn=document.getElementById("prev-transformation"),this.elements.nextTransformationBtn=document.getElementById("next-transformation"),this.elements.playTransformationBtn=document.getElementById("play-transformation"),this.elements.errorText=document.getElementById("error-text"),this.elements.pageInfo=document.getElementById("page-info"),this.elements.totalCharacters=document.getElementById("total-characters"),this.elements.totalPlanets=document.getElementById("total-planets"),this.elements.totalTransformations=document.getElementById("total-transformations"),this.elements.detailContent=document.getElementById("detail-content"),console.log("UIManager elements initialized:"),console.log("- Mobile menu:",!!this.elements.mobileMenu),console.log("- Mobile menu button:",!!this.elements.mobileMenuBtn)}get homeView(){return this.elements.homeView}get detailView(){return this.elements.detailView}get contentGrid(){return this.elements.contentGrid}get loadingSpinner(){return this.elements.loadingSpinner}get errorMessage(){return this.elements.errorMessage}get searchInput(){return this.elements.searchInput}get mobileMenu(){return this.elements.mobileMenu}get mobileMenuBtn(){return this.elements.mobileMenuBtn}get charactersTab(){return this.elements.charactersTab}get planetsTab(){return this.elements.planetsTab}get transformationsTab(){return this.elements.transformationsTab}get charactersTabMobile(){return this.elements.charactersTabMobile}get planetsTabMobile(){return this.elements.planetsTabMobile}get transformationsTabMobile(){return this.elements.transformationsTabMobile}get prevBtn(){return this.elements.prevBtn}get nextBtn(){return this.elements.nextBtn}get closeErrorBtn(){return this.elements.closeErrorBtn}get backBtn(){return this.elements.backBtn}get closeTransformationModalBtn(){return this.elements.closeTransformationModalBtn}get prevTransformationBtn(){return this.elements.prevTransformationBtn}get nextTransformationBtn(){return this.elements.nextTransformationBtn}get playTransformationBtn(){return this.elements.playTransformationBtn}get errorText(){return this.elements.errorText}get pageInfo(){return this.elements.pageInfo}get totalCharacters(){return this.elements.totalCharacters}get totalPlanets(){return this.elements.totalPlanets}get totalTransformations(){return this.elements.totalTransformations}get detailContent(){return this.elements.detailContent}showLoading(e){this.elements.loadingSpinner&&(e?this.elements.loadingSpinner.classList.remove("hidden"):this.elements.loadingSpinner.classList.add("hidden"))}showError(e){this.elements.errorText&&this.elements.errorMessage&&(this.elements.errorText.textContent=e,this.elements.errorMessage.classList.remove("hidden"),setTimeout(()=>{this.hideError()},5e3))}hideError(){this.elements.errorMessage&&this.elements.errorMessage.classList.add("hidden")}showHomeView(){this.elements.homeView?.classList.remove("hidden"),this.elements.detailView?.classList.add("hidden")}showDetailView(){this.elements.homeView?.classList.add("hidden"),this.elements.detailView?.classList.remove("hidden")}updateActiveTab(e){[{element:this.elements.charactersTab,name:"characters"},{element:this.elements.planetsTab,name:"planets"},{element:this.elements.transformationsTab,name:"transformations"}].forEach(({element:a,name:s})=>{a&&(s===e?a.classList.add("active"):a.classList.remove("active"))}),[{element:this.elements.charactersTabMobile,name:"characters"},{element:this.elements.planetsTabMobile,name:"planets"},{element:this.elements.transformationsTabMobile,name:"transformations"}].forEach(({element:a,name:s})=>{a&&(s===e?a.classList.add("active"):a.classList.remove("active"))})}toggleMobileMenu(){if(this.isToggling){console.log("Toggle already in progress, ignoring");return}this.isToggling=!0,console.log("Toggle mobile menu called, current state:",this.mobileMenuOpen);const e=this.elements.mobileMenu,t=this.elements.mobileMenuBtn?.querySelector("i");this.mobileMenuOpen?(console.log("Closing mobile menu"),this.mobileMenuOpen=!1,e?.classList.remove("mobile-menu-visible"),e?.classList.add("mobile-menu-hidden"),t?.classList.remove("fa-times"),t?.classList.add("fa-bars")):(console.log("Opening mobile menu"),this.mobileMenuOpen=!0,e?.classList.remove("mobile-menu-hidden"),e?.classList.add("mobile-menu-visible"),t?.classList.remove("fa-bars"),t?.classList.add("fa-times")),setTimeout(()=>{this.isToggling=!1},100)}closeMobileMenu(){const e=this.elements.mobileMenuBtn?.querySelector("i");this.mobileMenuOpen=!1,this.elements.mobileMenu?.classList.remove("mobile-menu-visible"),this.elements.mobileMenu?.classList.add("mobile-menu-hidden"),e?.classList.remove("fa-times"),e?.classList.add("fa-bars")}updatePagination(e,t){console.log("updatePagination called with:",{currentPage:e,totalPages:t}),console.log("Pagination buttons found:",{prevBtn:!!this.elements.prevBtn,nextBtn:!!this.elements.nextBtn,pageInfo:!!this.elements.pageInfo}),this.elements.prevBtn&&(this.elements.prevBtn.disabled=e===1,console.log("Previous button disabled:",this.elements.prevBtn.disabled)),this.elements.nextBtn&&(this.elements.nextBtn.disabled=e===t,console.log("Next button disabled:",this.elements.nextBtn.disabled)),this.elements.pageInfo&&(this.elements.pageInfo.textContent=`Página ${e} de ${t}`)}updateStats(e,t,n){this.elements.totalCharacters&&(this.elements.totalCharacters.textContent=e.toString()),this.elements.totalPlanets&&(this.elements.totalPlanets.textContent=t.toString()),this.elements.totalTransformations&&(this.elements.totalTransformations.textContent=n.toString())}renderContent(e){this.elements.contentGrid&&(this.elements.contentGrid.innerHTML=e)}renderDetailContent(e){this.elements.detailContent&&(this.elements.detailContent.innerHTML=e)}}const vt="https://dragonball-api.com/api";class yt{async fetchData(e){try{const t=await fetch(`${vt}${e}`);if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);return await t.json()}catch(t){throw console.error(`Error fetching ${e}:`,t),t}}getCharacters(e=1,t=10){return y(this.fetchData(`/characters?page=${e}&limit=${t}`)).pipe(x(n=>(console.error("Error getting characters:",n),M({items:[],meta:{totalItems:0,itemCount:0,itemsPerPage:t,totalPages:0,currentPage:e},links:{first:"",previous:"",next:"",last:""}}))))}getCharacterById(e){return y(this.fetchData(`/characters/${e}`)).pipe(x(t=>(console.error(`Error getting character ${e}:`,t),M(null))))}getPlanets(e=1,t=10){return y(this.fetchData(`/planets?page=${e}&limit=${t}`)).pipe(x(n=>(console.error("Error getting planets:",n),M({items:[],meta:{totalItems:0,itemCount:0,itemsPerPage:t,totalPages:0,currentPage:e},links:{first:"",previous:"",next:"",last:""}}))))}getTransformations(e=1,t=10){return y(this.fetchData("/transformations")).pipe(C(n=>{const a=(e-1)*t,s=a+t,i=n.slice(a,s);return{items:i,meta:{totalItems:n.length,itemCount:i.length,itemsPerPage:t,totalPages:Math.ceil(n.length/t),currentPage:e},links:{first:"",previous:"",next:"",last:""}}}),x(n=>(console.error("Error getting transformations:",n),M({items:[],meta:{totalItems:0,itemCount:0,itemsPerPage:t,totalPages:0,currentPage:e},links:{first:"",previous:"",next:"",last:""}}))))}searchCharacters(e){return y(this.fetchData(`/characters?name=${encodeURIComponent(e)}`)).pipe(C(t=>(console.log("Raw search response:",t),Array.isArray(t)?(console.log("Search returned array with",t.length,"items"),t):t&&t.items&&Array.isArray(t.items)?(console.log("Search returned object with items array"),t.items):(console.warn("Search response has unexpected structure:",t),[]))),x(t=>(console.error("Error searching characters:",t),M([]))))}getCharacterTransformations(e){return y(this.fetchData("/transformations")).pipe(C(t=>{const n=t.filter(a=>a.name.toLowerCase().includes(e.toLowerCase()));return console.log(`Found ${n.length} transformations for ${e}:`,n),n}),x(t=>(console.error(`Error getting transformations for ${e}:`,t),M([]))))}getPlanetById(e){return y(this.fetchData(`/planets/${e}`)).pipe(x(t=>(console.error(`Error getting planet ${e}:`,t),M(null))))}getTransformationById(e){return y(this.fetchData(`/transformations/${e}`)).pipe(x(t=>(console.error(`Error getting transformation ${e}:`,t),M(null))))}}const w=new yt;class xt{constructor(e){this.stateManager=e}renderCharacters(e){return console.log("renderCharacters called with:",e,"length:",e.length),!Array.isArray(e)||e.length===0?(console.log("renderCharacters: empty array, showing no results message"),'<div class="col-span-full text-center text-white py-8">No se encontraron personajes</div>'):(console.log("renderCharacters: rendering",e.length,"characters"),e.map(t=>`
      <div class="character-card card-shine card-with-overflow" onclick="app.navigateToDetail('character', ${t.id})">
        <div class="image-container aspect-square image-overflow-container bg-gradient-to-br from-orange-500/10 to-yellow-500/10 rounded-t-2xl">
          <img 
            src="${t.image}" 
            alt="${t.name}"
            class="w-full h-full object-scale-down image-overflow"
            onerror="this.src='https://via.placeholder.com/300x300/1f2937/f59e0b?text=${encodeURIComponent(t.name)}'"
          >
        </div>
        <div class="p-4 overflow-content">
          <h3 class="text-xl font-bold text-white mb-2 font-orbitron">${t.name}</h3>
          <div class="flex flex-wrap gap-2 mb-3">
            <span class="race-badge">${t.race}</span>
            <span class="gender-badge gender-${t.gender.toLowerCase()}">${t.gender}</span>
          </div>
          <div class="mb-3">
            <div class="flex justify-between text-sm text-gray-300 mb-1">
              <span>Poder</span>
              <span>${t.ki}</span>
            </div>
            <div class="power-level-bar">
              <div class="power-level-fill" style="width: ${this.calculatePowerPercentage(t.ki)}%"></div>
            </div>
          </div>
          <span class="affiliation-badge ${this.getAffiliationClass(t.affiliation)}">${t.affiliation}</span>
        </div>
      </div>
    `).join(""))}renderCharacterDetailPage(e){return`
      <div class="p-8">
        <div class="text-center mb-8">
          <h1 class="text-4xl md:text-5xl font-bold text-white font-orbitron mb-4">${e.name}</h1>
          <div class="flex flex-wrap justify-center gap-3 mb-6">
            <span class="race-badge text-lg px-4 py-2">${e.race}</span>
            <span class="gender-badge gender-${e.gender.toLowerCase()} text-lg px-4 py-2">${e.gender}</span>
            <span class="affiliation-badge ${this.getAffiliationClass(e.affiliation)} text-lg px-4 py-2">${e.affiliation}</span>
          </div>
          <div class="text-center mt-8">
            <button onclick="app.showTransformations('${e.name}', ${e.id})" class="transformation-btn">
              <i class="fas fa-bolt mr-2"></i>
              Ver Transformaciones
              <i class="fas fa-magic ml-2"></i>
            </button>
          </div>
        </div>

        <div class="grid lg:grid-cols-2 gap-8 mb-8">
          <div class="image-container aspect-square bg-gradient-to-br from-orange-500/20 to-yellow-500/20 border border-orange-500/30 rounded-3xl overflow-hidden">
            <img 
              src="${e.image}" 
              alt="${e.name}"
              class="w-full h-full object-scale-down"
              onerror="this.src='https://via.placeholder.com/600x600/1f2937/f59e0b?text=${encodeURIComponent(e.name)}'"
            >
          </div>
          
          <div class="space-y-6">
            <div class="bg-black/30 backdrop-blur-md border border-orange-500/30 rounded-2xl p-6">
              <h3 class="text-2xl font-semibold text-orange-400 mb-4 flex items-center">
                <i class="fas fa-book mr-3"></i>
                Historia
              </h3>
              <p class="text-gray-300 leading-relaxed text-lg">${e.description}</p>
            </div>
            
            <div class="bg-black/30 backdrop-blur-md border border-orange-500/30 rounded-2xl p-6">
              <h3 class="text-2xl font-semibold text-orange-400 mb-4 flex items-center">
                <i class="fas fa-info-circle mr-3"></i>
                Información Básica
              </h3>
              <div class="space-y-3">
                <div class="flex justify-between items-center py-2 border-b border-white/10">
                  <span class="text-gray-300 font-medium">Raza:</span>
                  <span class="text-white font-semibold">${e.race}</span>
                </div>
                <div class="flex justify-between items-center py-2 border-b border-white/10">
                  <span class="text-gray-300 font-medium">Género:</span>
                  <span class="text-white font-semibold">${e.gender}</span>
                </div>
                <div class="flex justify-between items-center py-2 border-b border-white/10">
                  <span class="text-gray-300 font-medium">Afiliación:</span>
                  <span class="text-white font-semibold">${e.affiliation}</span>
                </div>
              </div>
            </div>
            
            <div class="bg-black/30 backdrop-blur-md border border-orange-500/30 rounded-2xl p-6">
              <h3 class="text-2xl font-semibold text-orange-400 mb-4 flex items-center">
                <i class="fas fa-fist-raised mr-3"></i>
                Nivel de Poder
              </h3>
              <div class="space-y-4">
                <div>
                  <div class="flex justify-between text-sm text-gray-300 mb-2">
                    <span>Ki Base</span>
                    <span class="text-orange-300 font-bold">${e.ki}</span>
                  </div>
                  <div class="power-level-bar h-4 mb-4">
                    <div class="power-level-fill h-full" style="width: ${this.calculatePowerPercentage(e.ki)}%"></div>
                  </div>
                </div>
                <div>
                  <div class="flex justify-between text-sm text-gray-300 mb-2">
                    <span>Ki Máximo</span>
                    <span class="text-yellow-300 font-bold">${e.maxKi}</span>
                  </div>
                  <div class="power-level-bar h-4">
                    <div class="power-level-fill h-full" style="width: ${this.calculatePowerPercentage(e.maxKi)}%"></div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    `}loadCharacters(e,t=12){return w.getCharacters(e,t)}searchCharacters(e){return w.searchCharacters(e)}getCharacterById(e){return w.getCharacterById(e)}calculatePowerPercentage(e){const t=e.toLowerCase();if(t.includes("unknown")||t==="0")return 0;if(t.includes("trillion")||t.includes("septillion"))return 100;if(t.includes("billion"))return 85;if(t.includes("million"))return 70;if(t.includes("thousand"))return 50;const n=e.match(/[\d,]+/g);if(n&&n.length>0){const a=parseInt(n[0].replace(/,/g,""));return a>1e9?100:a>1e8?90:a>1e7?80:a>1e6?70:a>1e5?60:a>1e4?50:a>1e3?40:Math.min(30,a/1e3*30)}return 30}getAffiliationClass(e){const t=e.toLowerCase();return t.includes("z fighter")||t.includes("hero")?"affiliation-z-fighter":t.includes("villain")||t.includes("army")?"affiliation-villain":t.includes("other")?"affiliation-other":"affiliation-neutral"}}class wt{constructor(e){this.stateManager=e}renderPlanets(e){return!Array.isArray(e)||e.length===0?'<div class="col-span-full text-center text-white py-8">No se encontraron planetas</div>':e.map(t=>`
      <div class="planet-card card-shine" onclick="app.navigateToDetail('planet', ${t.id})">
        <div class="image-container aspect-square">
          <img 
            src="${t.image}" 
            alt="${t.name}"
            class="w-full h-full object-cover"
            onerror="this.src='https://via.placeholder.com/300x300/1f2937/3b82f6?text=${encodeURIComponent(t.name)}'"
          >
        </div>
        <div class="p-4">
          <h3 class="text-xl font-bold text-white mb-2 font-orbitron">${t.name}</h3>
          <div class="mb-3">
            <div class="flex items-center justify-between mb-2">
              <span class="text-sm text-gray-300">Estado</span>
              <span class="px-2 py-1 rounded-full text-xs font-medium ${t.isDestroyed?"bg-red-500/20 text-red-300":"bg-green-500/20 text-green-300"}">
                ${t.isDestroyed?"Destruido":"Intacto"}
              </span>
            </div>
          </div>
          <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-blue-500/20 text-blue-300 border border-blue-500/30">
            <i class="fas fa-globe mr-1"></i>
            Planeta
          </span>
        </div>
      </div>
    `).join("")}renderPlanetDetailPage(e){return`
      <div class="p-8">
        <div class="text-center mb-8">
          <h1 class="text-4xl md:text-5xl font-bold text-white font-orbitron mb-4">${e.name}</h1>
          <div class="flex justify-center mb-6">
            <span class="inline-flex items-center px-6 py-3 rounded-full text-lg font-medium ${e.isDestroyed?"bg-red-500/20 text-red-300 border border-red-500/30":"bg-green-500/20 text-green-300 border border-green-500/30"}">
              <i class="fas fa-${e.isDestroyed?"skull-crossbones":"check-circle"} mr-3 text-xl"></i>
              ${e.isDestroyed?"DESTRUIDO":"INTACTO"}
            </span>
          </div>
        </div>

        <div class="grid lg:grid-cols-2 gap-8 mb-8">
          <div class="image-container aspect-square bg-gradient-to-br from-blue-500/20 to-cyan-500/20 border border-blue-500/30 rounded-3xl overflow-hidden">
            <img 
              src="${e.image}" 
              alt="${e.name}"
              class="w-full h-full object-cover"
              onerror="this.src='https://via.placeholder.com/600x600/1f2937/3b82f6?text=${encodeURIComponent(e.name)}'"
            >
          </div>
          
          <div class="space-y-6">
            <div class="bg-black/30 backdrop-blur-md border border-blue-500/30 rounded-2xl p-6">
              <h3 class="text-2xl font-semibold text-blue-400 mb-4 flex items-center">
                <i class="fas fa-globe mr-3"></i>
                Información del Planeta
              </h3>
              <div class="space-y-4">
                <div class="text-center p-4 rounded-xl ${e.isDestroyed?"bg-red-500/10 border border-red-500/30":"bg-green-500/10 border border-green-500/30"}">
                  <div class="text-3xl font-bold ${e.isDestroyed?"text-red-400":"text-green-400"} mb-2">
                    ${e.isDestroyed?"DESTRUIDO":"INTACTO"}
                  </div>
                  <p class="text-gray-300 mt-4">
                    ${e.isDestroyed?"Este planeta ha sido destruido y ya no existe en el universo.":"Este planeta permanece intacto y habitable."}
                  </p>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <div class="bg-black/30 backdrop-blur-md border border-blue-500/30 rounded-2xl p-6">
          <h3 class="text-2xl font-semibold text-blue-400 mb-4 flex items-center">
            <i class="fas fa-book mr-3"></i>
            Descripción
          </h3>
          <p class="text-gray-300 leading-relaxed text-lg">${e.description}</p>
        </div>
      </div>
    `}loadPlanets(e,t=12){return w.getPlanets(e,t)}getPlanetById(e){return w.getPlanetById(e)}filterPlanetsByName(e,t){if(!t.trim())return e;const n=t.toLowerCase();return e.filter(a=>a.name.toLowerCase().includes(n)||a.description.toLowerCase().includes(n))}}class Tt{constructor(e){this.stateManager=e,this.currentTransformations=[],this.currentTransformationIndex=0,this.isTransformationPlaying=!1,this.transformationInterval=null}renderTransformations(e){return!Array.isArray(e)||e.length===0?'<div class="col-span-full text-center text-white py-8">No se encontraron transformaciones</div>':e.map(t=>`
      <div class="transformation-card card-shine card-with-overflow" onclick="app.navigateToDetail('transformation', ${t.id})">
        <div class="image-container aspect-square image-overflow-container bg-gradient-to-br from-purple-500/10 to-pink-500/10 rounded-t-2xl">
          <img 
            src="${t.image}" 
            alt="${t.name}"
            class="w-full h-full object-scale-down image-overflow"
            onerror="this.src='https://via.placeholder.com/300x300/1f2937/8b5cf6?text=${encodeURIComponent(t.name)}'"
          >
        </div>
        <div class="p-4 overflow-content">
          <h3 class="text-xl font-bold text-white mb-2 font-orbitron">${t.name}</h3>
          <div class="mb-3">
            <div class="flex justify-between text-sm text-gray-300 mb-1">
              <span>Poder</span>
              <span>${t.ki}</span>
            </div>
            <div class="power-level-bar">
              <div class="power-level-fill" style="width: ${this.calculatePowerPercentage(t.ki)}%"></div>
            </div>
          </div>
          <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-purple-500/20 text-purple-300 border border-purple-500/30">
            <i class="fas fa-bolt mr-1"></i>
            Transformación
          </span>
        </div>
      </div>
    `).join("")}renderTransformationDetailPage(e){return`
      <div class="p-8">
        <div class="text-center mb-8">
          <h1 class="text-4xl md:text-5xl font-bold text-white font-orbitron mb-4">${e.name}</h1>
          <div class="flex justify-center mb-6">
            <span class="inline-flex items-center px-6 py-3 rounded-full text-lg font-medium bg-purple-500/20 text-purple-300 border border-purple-500/30">
              <i class="fas fa-bolt mr-3 text-xl"></i>
              Transformación
            </span>
          </div>
        </div>

        <div class="grid lg:grid-cols-2 gap-8 mb-8">
          <div class="image-container aspect-square bg-gradient-to-br from-purple-500/20 to-pink-500/20 border border-purple-500/30 rounded-3xl overflow-hidden">
            <img 
              src="${e.image}" 
              alt="${e.name}"
              class="w-full h-full object-scale-down"
              onerror="this.src='https://via.placeholder.com/600x600/1f2937/8b5cf6?text=${encodeURIComponent(e.name)}'"
            >
          </div>
          
          <div class="space-y-6">
            <div class="bg-black/30 backdrop-blur-md border border-purple-500/30 rounded-2xl p-6">
              <h3 class="text-2xl font-semibold text-purple-400 mb-4 flex items-center">
                <i class="fas fa-bolt mr-3"></i>
                Nivel de Poder
              </h3>
              <div class="space-y-4">
                <div>
                  <div class="flex justify-between text-sm text-gray-300 mb-2">
                    <span>Ki de Transformación</span>
                    <span class="text-purple-300 font-bold">${e.ki}</span>
                  </div>
                  <div class="power-level-bar h-4">
                    <div class="power-level-fill h-full" style="width: ${this.calculatePowerPercentage(e.ki)}%"></div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    `}loadTransformations(e,t=12){return w.getTransformations(e,t)}getTransformationById(e){return w.getTransformationById(e)}filterTransformationsByName(e,t){if(!t.trim())return e;const n=t.toLowerCase();return e.filter(a=>a.name.toLowerCase().includes(n))}showTransformations(e,t){console.log(`Loading transformations for ${e}`),w.getCharacterById(t).subscribe({next:n=>{if(n)w.getCharacterTransformations(e).subscribe({next:a=>{this.currentTransformations=[{id:n.id,name:`${n.name} (Original)`,image:n.image,ki:n.ki},...a],this.currentTransformationIndex=0,this.openTransformationModal(e),this.displayCurrentTransformation()},error:a=>{console.error("Error loading transformations:",a),this.currentTransformations=[{id:n.id,name:`${n.name} (Original)`,image:n.image,ki:n.ki}],this.currentTransformationIndex=0,this.openTransformationModal(e),this.displayCurrentTransformation()}});else{const a=new CustomEvent("showError",{detail:`No se encontró el personaje ${e}`});window.dispatchEvent(a)}},error:n=>{console.error("Error loading character:",n);const a=new CustomEvent("showError",{detail:"Error al cargar el personaje"});window.dispatchEvent(a)}})}openTransformationModal(e){const t=document.getElementById("transformation-modal"),n=document.getElementById("transformation-title");t&&n&&(n.innerHTML=`<i class="fas fa-bolt text-orange-400 mr-3"></i>Transformaciones de ${e}`,t.classList.remove("hidden"),t.classList.add("modal-enter"))}closeTransformationModal(){const e=document.getElementById("transformation-modal");e&&(e.classList.add("hidden"),e.classList.remove("modal-enter")),this.stopTransformationSequence()}displayCurrentTransformation(){if(console.log("displayCurrentTransformation called, index:",this.currentTransformationIndex,"total:",this.currentTransformations.length),this.currentTransformations.length===0){console.log("No transformations available");return}const e=this.currentTransformations[this.currentTransformationIndex];if(console.log("Current transformation:",e?.name),!e)return;const t=document.getElementById("transformation-image"),n=document.getElementById("current-transformation-name"),a=document.getElementById("current-transformation-power"),s=document.getElementById("transformation-counter"),i=document.getElementById("transformation-power-fill");if(t&&n&&a&&s&&i){t.src=e.image,t.alt=e.name,n.textContent=e.name,a.textContent=`Poder: ${e.ki}`,s.textContent=`${this.currentTransformationIndex+1} / ${this.currentTransformations.length}`;const c=this.calculatePowerPercentage(e.ki);i.style.width=`${c}%`,this.updateTransformationButtons()}}updateTransformationButtons(){const e=document.getElementById("prev-transformation"),t=document.getElementById("next-transformation"),n=document.getElementById("play-transformation");if(console.log("Updating transformation buttons:",{currentIndex:this.currentTransformationIndex,totalTransformations:this.currentTransformations.length,prevBtnFound:!!e,nextBtnFound:!!t,playBtnFound:!!n}),e&&t&&n){const a=this.currentTransformationIndex===0,s=this.currentTransformationIndex===this.currentTransformations.length-1;console.log("Button states:",{shouldDisablePrev:a,shouldDisableNext:s,isPlaying:this.isTransformationPlaying}),e.disabled=a,t.disabled=s,this.isTransformationPlaying?n.innerHTML='<i class="fas fa-pause mr-2"></i>Pausar':n.innerHTML='<i class="fas fa-play mr-2"></i>Transformar'}else console.log("Some buttons not found!")}previousTransformation(){console.log("Previous transformation clicked, current index:",this.currentTransformationIndex),this.currentTransformationIndex>0?(this.currentTransformationIndex--,console.log("New index:",this.currentTransformationIndex),this.displayCurrentTransformation()):console.log("Already at first transformation")}nextTransformation(){console.log("Next transformation clicked, current index:",this.currentTransformationIndex,"total:",this.currentTransformations.length),this.currentTransformationIndex<this.currentTransformations.length-1?(this.currentTransformationIndex++,console.log("New index:",this.currentTransformationIndex),this.displayCurrentTransformation()):console.log("Already at last transformation")}playTransformationSequence(){this.isTransformationPlaying?this.stopTransformationSequence():this.startTransformationSequence()}startTransformationSequence(){this.isTransformationPlaying=!0,this.updateTransformationButtons(),this.currentTransformationIndex===this.currentTransformations.length-1&&(this.currentTransformationIndex=0),this.transformationInterval=window.setInterval(()=>{this.nextTransformation(),this.currentTransformationIndex===this.currentTransformations.length-1&&this.stopTransformationSequence()},2e3)}stopTransformationSequence(){this.isTransformationPlaying=!1,this.transformationInterval&&(clearInterval(this.transformationInterval),this.transformationInterval=null),this.updateTransformationButtons()}animateTransformation(){const e=document.getElementById("transformation-image"),t=document.getElementById("power-aura"),n=document.getElementById("transformation-display");if(e&&t&&n){const a=document.createElement("div");a.className="absolute inset-0 bg-white transformation-flash",n.appendChild(a),t.style.opacity="1",t.classList.add("energy-burst"),n.classList.add("aura-active"),e.classList.add("transformation-enter"),setTimeout(()=>{a.remove(),t.style.opacity="0.7",t.classList.remove("energy-burst"),e.classList.remove("transformation-enter"),setTimeout(()=>{n.classList.remove("aura-active"),t.style.opacity="0"},1e3)},800),setTimeout(()=>{console.log("Updating transformation display after animation"),this.displayCurrentTransformation()},300)}else console.log("Animation elements not found, updating display directly"),this.displayCurrentTransformation()}calculatePowerPercentage(e){if(!e||e.toLowerCase().includes("unknown")||e==="0")return 0;const t=e.toLowerCase().replace(/[,\.]/g,""),n=[{name:"thousand",value:1e3,percentage:20},{name:"million",value:1e6,percentage:35},{name:"billion",value:1e9,percentage:50},{name:"trillion",value:1e12,percentage:65},{name:"quadrillion",value:1e15,percentage:75},{name:"quintillion",value:1e18,percentage:80},{name:"sextillion",value:1e21,percentage:85},{name:"septillion",value:1e24,percentage:90},{name:"octillion",value:1e27,percentage:95},{name:"nonillion",value:1e30,percentage:98},{name:"decillion",value:1e33,percentage:100}];for(let s=n.length-1;s>=0;s--){const i=n[s];if(i&&t.includes(i.name)){const c=e.match(new RegExp(`(\\d+(?:[,\\.\\d]+)?)\\s*${i.name}`,"i"));if(c?.[1]){const l=parseFloat(c[1].replace(/,/g,""));let o=i.percentage;return l>=100?o=Math.min(100,o+10):l>=10&&(o=Math.min(100,o+5)),o}return i.percentage}}const a=e.match(/[\d,]+/g);if(a&&a.length>0){const s=parseInt(a[0].replace(/,/g,""));return s>=1e9?50:s>=1e8?45:s>=1e7?40:s>=1e6?35:s>=1e5?30:s>=1e4?25:s>=1e3?20:s>=100?15:s>=10?10:Math.max(5,s/10*5)}return 15}}class ye{constructor(){this.ITEMS_PER_PAGE=12,this.isLoadingDetail=!1,this.stateManager=new pt,this.uiManager=new bt,this.charactersModule=new xt(this.stateManager),this.planetsModule=new wt(this.stateManager),this.transformationsModule=new Tt(this.stateManager),this.initializeApp(),this.setupEventListeners(),this.setupDataStreams(),this.loadInitialData()}initializeApp(){console.log("Dragon Ball App initialized with modular architecture")}setupEventListeners(){this.uiManager.charactersTab&&h(this.uiManager.charactersTab,"click").subscribe(()=>this.switchTab("characters")),this.uiManager.planetsTab&&h(this.uiManager.planetsTab,"click").subscribe(()=>this.switchTab("planets")),this.uiManager.transformationsTab&&h(this.uiManager.transformationsTab,"click").subscribe(()=>this.switchTab("transformations")),this.uiManager.charactersTabMobile&&h(this.uiManager.charactersTabMobile,"click").subscribe(()=>{this.switchTab("characters"),this.uiManager.closeMobileMenu()}),this.uiManager.planetsTabMobile&&h(this.uiManager.planetsTabMobile,"click").subscribe(()=>{this.switchTab("planets"),this.uiManager.closeMobileMenu()}),this.uiManager.transformationsTabMobile&&h(this.uiManager.transformationsTabMobile,"click").subscribe(()=>{this.switchTab("transformations"),this.uiManager.closeMobileMenu()}),this.uiManager.mobileMenuBtn&&h(this.uiManager.mobileMenuBtn,"click").subscribe(e=>{e.preventDefault(),e.stopPropagation(),this.uiManager.toggleMobileMenu()}),console.log("Pagination event listeners setup:",{prevBtn:!!this.uiManager.prevBtn,nextBtn:!!this.uiManager.nextBtn}),this.uiManager.prevBtn&&h(this.uiManager.prevBtn,"click").subscribe(()=>{console.log("Previous page clicked"),this.changePage(-1)}),this.uiManager.nextBtn&&h(this.uiManager.nextBtn,"click").subscribe(()=>{console.log("Next page clicked"),this.changePage(1)}),this.uiManager.closeErrorBtn&&h(this.uiManager.closeErrorBtn,"click").subscribe(()=>this.uiManager.hideError()),this.uiManager.backBtn&&h(this.uiManager.backBtn,"click").subscribe(()=>this.goBack()),console.log("Setting up transformation modal event listeners:",{closeBtn:!!this.uiManager.closeTransformationModalBtn,prevBtn:!!this.uiManager.prevTransformationBtn,nextBtn:!!this.uiManager.nextTransformationBtn,playBtn:!!this.uiManager.playTransformationBtn}),this.uiManager.closeTransformationModalBtn&&h(this.uiManager.closeTransformationModalBtn,"click").subscribe(()=>{console.log("Close button clicked"),this.transformationsModule.closeTransformationModal(),this.goBack()}),this.uiManager.prevTransformationBtn&&h(this.uiManager.prevTransformationBtn,"click").subscribe(()=>{console.log("Previous button clicked"),this.transformationsModule.previousTransformation()}),this.uiManager.nextTransformationBtn&&h(this.uiManager.nextTransformationBtn,"click").subscribe(()=>{console.log("Next button clicked"),this.transformationsModule.nextTransformation()}),this.uiManager.playTransformationBtn&&h(this.uiManager.playTransformationBtn,"click").subscribe(()=>{console.log("Play button clicked"),this.transformationsModule.playTransformationSequence()}),h(window,"showError").subscribe(e=>{this.uiManager.showError(e.detail)})}setupDataStreams(){this.stateManager.state$.pipe(gt(e=>this.updateUI(e))).subscribe(),this.uiManager.searchInput&&h(this.uiManager.searchInput,"input").pipe(C(e=>e.target.value),ft(300),ht()).subscribe(e=>{this.stateManager.updateState({searchTerm:e,currentPage:1}),this.stateManager.currentState.currentView==="home"&&setTimeout(()=>this.loadDataIfNeeded(),0)})}updateUI(e){e.currentView==="home"?this.uiManager.showHomeView():(this.uiManager.showDetailView(),e.currentDetailId&&e.currentDetailType&&!this.isLoadingDetail&&this.loadDetailPage()),this.uiManager.updateActiveTab(e.currentTab),this.uiManager.showLoading(e.isLoading),console.log("About to update pagination with state:",{currentPage:e.currentPage,totalPages:e.totalPages,currentTab:e.currentTab,totalCharacters:e.totalCharacters,totalPlanets:e.totalPlanets,totalTransformations:e.totalTransformations}),this.uiManager.updatePagination(e.currentPage,e.totalPages),this.uiManager.updateStats(e.totalCharacters,e.totalPlanets,e.totalTransformations)}loadDataIfNeeded(){const{currentTab:e,currentPage:t,searchTerm:n}=this.stateManager.currentState;n.trim()?this.performSearch(n,e):this.loadTabData(e,t)}loadTabData(e,t){console.log(`Loading tab data: ${e}, page: ${t}`);const n=this.stateManager.getCacheKey(e,t),a=e;if(this.stateManager.hasCachedData(n)){console.log(`Using cached data for ${e} page ${t}`),this.renderCachedData(e,n);return}this.stateManager.updateState({isLoading:!0});const i=((c,l)=>{switch(c){case"characters":return this.charactersModule.loadCharacters(l,this.ITEMS_PER_PAGE);case"planets":return this.planetsModule.loadPlanets(l,this.ITEMS_PER_PAGE);case"transformations":return this.transformationsModule.loadTransformations(l,this.ITEMS_PER_PAGE);default:return null}})(e,t);if(!i){this.stateManager.updateState({isLoading:!1});return}i.subscribe({next:c=>{console.log(`API response for ${e} page ${t}:`,c);const l=c.items||[],o=c.meta||{};console.log(`Items received: ${l.length}, Total items: ${o.totalItems}`);const u={isLoading:!1,totalPages:Math.ceil((o.totalItems||0)/this.ITEMS_PER_PAGE)};switch(console.log(`Calculated total pages: ${u.totalPages}`),e){case"characters":u.characters=l,u.totalCharacters=o.totalItems||0;break;case"planets":u.planets=l,u.totalPlanets=o.totalItems||0;break;case"transformations":u.transformations=l,u.totalTransformations=o.totalItems||0;break}this.stateManager.updateState(u),this.stateManager.setCachedData(n,l),this.stateManager.setDataLoaded(a,!0),this.renderCurrentTab(e,l)},error:c=>{console.error(`Error loading ${e}:`,c),this.uiManager.showError(`Error al cargar ${e}`),this.stateManager.updateState({isLoading:!1})}})}renderCachedData(e,t){const n=this.stateManager.getCachedData(t)||[],a=this.stateManager.currentState;let s=1;switch(e){case"characters":s=Math.ceil(a.totalCharacters/this.ITEMS_PER_PAGE);break;case"planets":s=Math.ceil(a.totalPlanets/this.ITEMS_PER_PAGE);break;case"transformations":s=Math.ceil(a.totalTransformations/this.ITEMS_PER_PAGE);break}this.stateManager.updateState({isLoading:!1,totalPages:s}),this.renderCurrentTab(e,n)}renderCurrentTab(e,t){let n="";switch(e){case"characters":n=this.charactersModule.renderCharacters(t);break;case"planets":n=this.planetsModule.renderPlanets(t);break;case"transformations":n=this.transformationsModule.renderTransformations(t);break}this.uiManager.renderContent(n)}performSearch(e,t){switch(this.stateManager.updateState({isLoading:!0}),t){case"characters":this.charactersModule.searchCharacters(e).subscribe({next:s=>{const i=Math.ceil(s.length/this.ITEMS_PER_PAGE);console.log("Search results - characters:",s.length,"totalPages:",i),this.stateManager.updateState({characters:s,isLoading:!1,totalPages:i}),this.uiManager.renderContent(this.charactersModule.renderCharacters(s))},error:s=>{console.error("Error searching characters:",s),this.uiManager.showError("Error al buscar personajes"),this.stateManager.updateState({characters:[],isLoading:!1}),this.uiManager.renderContent(this.charactersModule.renderCharacters([]))}});break;case"planets":const n=this.stateManager.currentState.planets;if(n.length>0){const s=this.planetsModule.filterPlanetsByName(n,e),i=Math.ceil(s.length/this.ITEMS_PER_PAGE);console.log("Filtered planets:",s.length,"totalPages:",i),this.stateManager.updateState({planets:s,isLoading:!1,totalPages:i}),this.uiManager.renderContent(this.planetsModule.renderPlanets(s))}else this.planetsModule.loadPlanets(1,this.ITEMS_PER_PAGE).subscribe({next:s=>{const i=s.items||[],c=this.planetsModule.filterPlanetsByName(i,e),l=Math.ceil(c.length/this.ITEMS_PER_PAGE);console.log("Filtered planets (after load):",c.length,"totalPages:",l),this.stateManager.updateState({planets:c,isLoading:!1,totalPages:l}),this.uiManager.renderContent(this.planetsModule.renderPlanets(c))},error:s=>{console.error("Error searching planets:",s),this.uiManager.showError("Error al buscar planetas"),this.stateManager.updateState({planets:[],isLoading:!1}),this.uiManager.renderContent(this.planetsModule.renderPlanets([]))}});break;case"transformations":const a=this.stateManager.currentState.transformations;if(a.length>0){const s=this.transformationsModule.filterTransformationsByName(a,e),i=Math.ceil(s.length/this.ITEMS_PER_PAGE);console.log("Filtered transformations:",s.length,"totalPages:",i),this.stateManager.updateState({transformations:s,isLoading:!1,totalPages:i}),this.uiManager.renderContent(this.transformationsModule.renderTransformations(s))}else this.transformationsModule.loadTransformations(1,this.ITEMS_PER_PAGE).subscribe({next:s=>{const i=s.items||[],c=this.transformationsModule.filterTransformationsByName(i,e),l=Math.ceil(c.length/this.ITEMS_PER_PAGE);console.log("Filtered transformations (after load):",c.length,"totalPages:",l),this.stateManager.updateState({transformations:c,isLoading:!1,totalPages:l}),this.uiManager.renderContent(this.transformationsModule.renderTransformations(c))},error:s=>{console.error("Error searching transformations:",s),this.uiManager.showError("Error al buscar transformaciones"),this.stateManager.updateState({transformations:[],isLoading:!1}),this.uiManager.renderContent(this.transformationsModule.renderTransformations([]))}});break}}loadInitialData(){this.loadTabData("characters",1),this.stateManager.isDataLoaded("stats")||(this.loadStatsOnly(),this.stateManager.setDataLoaded("stats",!0))}loadStatsOnly(){this.planetsModule.loadPlanets(1,this.ITEMS_PER_PAGE).subscribe({next:e=>{const t=e.meta||{};this.stateManager.updateState({totalPlanets:t.totalItems||0})},error:e=>console.error("Error loading planets stats:",e)}),this.transformationsModule.loadTransformations(1,this.ITEMS_PER_PAGE).subscribe({next:e=>{const t=e.meta||{};this.stateManager.updateState({totalTransformations:t.totalItems||0})},error:e=>console.error("Error loading transformations stats:",e)})}switchTab(e){const t=this.stateManager.currentState;(t.currentTab!==e||t.currentView!=="home")&&(this.stateManager.updateState({currentTab:e,currentPage:1,searchTerm:"",currentView:"home",currentDetailId:null,currentDetailType:null}),this.uiManager.searchInput&&(this.uiManager.searchInput.value=""),this.loadDataIfNeeded())}changePage(e){const t=this.stateManager.currentState,n=t.currentPage+e;console.log("changePage called:",{direction:e,currentPage:t.currentPage,newPage:n,totalPages:t.totalPages,canChange:n>=1&&n<=t.totalPages}),n>=1&&n<=t.totalPages?(console.log("Changing to page:",n),this.stateManager.updateState({currentPage:n}),this.loadDataIfNeeded()):console.log("Cannot change page - out of bounds")}navigateToDetail(e,t){this.isLoadingDetail=!1,this.stateManager.updateState({currentView:"detail",currentDetailType:e,currentDetailId:t})}goBack(){this.stateManager.updateState({currentView:"home",currentDetailId:null,currentDetailType:null})}loadDetailPage(){const e=this.stateManager.currentState,{currentDetailType:t,currentDetailId:n}=e;if(!t||!n||this.isLoadingDetail)return;this.isLoadingDetail=!0,this.stateManager.updateState({isLoading:!0});let a=null;switch(t){case"character":a=e.characters.find(i=>i.id===n);break;case"planet":a=e.planets.find(i=>i.id===n);break;case"transformation":a=e.transformations.find(i=>i.id===n);break}if(a){this.renderDetailContent(t,a),this.stateManager.updateState({isLoading:!1}),this.isLoadingDetail=!1;return}let s=null;switch(t){case"character":s=this.charactersModule.getCharacterById(n);break;case"planet":s=this.planetsModule.getPlanetById(n);break;case"transformation":s=this.transformationsModule.getTransformationById(n);break}s?s.subscribe({next:i=>{i?this.renderDetailContent(t,i):this.uiManager.showError("No se encontró el elemento solicitado"),this.stateManager.updateState({isLoading:!1}),this.isLoadingDetail=!1},error:i=>{console.error(`Error loading ${t} detail:`,i),this.uiManager.showError(`Error al cargar los detalles de ${t}`),this.stateManager.updateState({isLoading:!1}),this.isLoadingDetail=!1}}):this.isLoadingDetail=!1}renderDetailContent(e,t){let n="";switch(e){case"character":n=this.charactersModule.renderCharacterDetailPage(t);break;case"planet":n=this.planetsModule.renderPlanetDetailPage(t);break;case"transformation":n=this.transformationsModule.renderTransformationDetailPage(t);break}this.uiManager.renderDetailContent(n)}showTransformations(e,t){this.uiManager.showLoading(!0),this.transformationsModule.showTransformations(e,t),this.uiManager.showLoading(!1)}}const Mt=new ye;window.app=Mt;h(document,"DOMContentLoaded").subscribe(()=>{console.log("🐉 Iniciando Dragon Ball Universe App...");const r=new ye;window.app=r,console.log("✨ Dragon Ball Universe App iniciada correctamente!")});h(window,"error").subscribe(r=>{console.error("Error global capturado:",r.error)});h(window,"unhandledrejection").subscribe(r=>{console.error("Promise rechazada no manejada:",r.reason),r.preventDefault()});
